# æ¨¡å—äº”ï¼šå‰ç«¯å¯è§†åŒ–ç•Œé¢ï¼ˆæœ€ç»ˆç‰ˆï¼‰

> **çŠ¶æ€**: æœ€ç»ˆç‰ˆ v2.0 | **ä¼˜å…ˆçº§**: P0 | **é¢„è®¡æ—¶é—´**: 12h

## ğŸ¯ è®¾è®¡ç›®æ ‡ï¼šESPNå¼"God View"ç›´æ’­ä½“éªŒ

> **å‚è€ƒ**: ESPNæ‰‘å…‹é”¦æ ‡èµ›ç›´æ’­ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰äººçš„åº•ç‰Œ

### æ ¸å¿ƒä½“éªŒ

| ç‰¹æ€§ | æ•ˆæœ | ä¼˜å…ˆçº§ |
|------|------|--------|
| ğŸ´ å…¨é€æ˜åº•ç‰Œ | è§‚ä¼—èƒ½çœ‹åˆ°æ‰€æœ‰AIçš„æ‰‹ç‰Œ | P0 |
| ğŸ’¬ å®æ—¶å¯¹è¯æµ | æ‰“å­—æœºæ•ˆæœçš„AIäº’æ€¼ | P0 |
| ğŸ² æŠ•æ³¨é¢æ¿ | ä¸€é”®ä¸‹æ³¨é¢„æµ‹è·èƒœè€… | P0 |
| âœ… éªŒè¯é¢æ¿ | å±•ç¤ºé“¾ä¸Šå¯éªŒè¯æµç¨‹ | P0 |
| ğŸ“Š èµ”ç‡æ˜¾ç¤º | å®æ—¶èµ”ç‡å˜åŒ– | P1 |

---

## 1. æ•´ä½“å¸ƒå±€

### 1.1 æ¡Œé¢ç«¯å¸ƒå±€ï¼ˆ1440px+ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸƒ PokerMind Arena    â”ƒ  Round 3 of 5  â”ƒ  â± 00:47  â”ƒ  ğŸ”— Verified  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                             â”‚   â”‚
â”‚   â”‚    ğŸ”¥ ç«ç„°                              ğŸ§Š å†°å±±              â”‚   â”‚
â”‚   â”‚    Aâ™  Kâ™¥                               Qâ™¦ Qâ™£               â”‚   â”‚
â”‚   â”‚    $800  [ALL-IN]                      $1200               â”‚   â”‚
â”‚   â”‚                                                             â”‚   â”‚
â”‚   â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚   â”‚
â”‚   â”‚                   â”‚    Jâ™  10â™¥ 9â™£    â”‚                       â”‚   â”‚
â”‚   â”‚                   â”‚     POT $450    â”‚                       â”‚   â”‚
â”‚   â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚                                                             â”‚   â”‚
â”‚   â”‚    ğŸ­ è¯¡å½±                              ğŸ§  é€»è¾‘              â”‚   â”‚
â”‚   â”‚    8â™  8â™¥                               Aâ™¦ Jâ™¦               â”‚   â”‚
â”‚   â”‚    [FOLD]                              $950                â”‚   â”‚
â”‚   â”‚                                                             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚                                            â”‚
â”‚   ğŸ’¬ AI å¯¹è¯            â”‚   ğŸ² é¢„æµ‹å¸‚åœº                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚   ğŸ”¥ ç«ç„°: @å†°å±± åˆç¼©äº† â”‚   è°ä¼šèµ¢å¾—è¿™åœºæ¯”èµ›ï¼Ÿ                       â”‚
â”‚             ï¼Ÿæ¥å•Šï¼â–Š   â”‚                                            â”‚
â”‚                         â”‚   ğŸ”¥ ç«ç„°  [====   ] 45% | 1.8x           â”‚
â”‚   ğŸ§Š å†°å±±: å†²åŠ¨çš„ä»£ä»·.. â”‚   ğŸ§Š å†°å±±  [===    ] 35% | 2.4x           â”‚
â”‚                         â”‚   ğŸ­ è¯¡å½±  [=      ] 12% | 6.5x           â”‚
â”‚   ğŸ­ è¯¡å½±: Fold...      â”‚   ğŸ§  é€»è¾‘  [=      ]  8% | 9.2x           â”‚
â”‚                         â”‚                                            â”‚
â”‚                         â”‚   [10] [25] [50] [100]                     â”‚
â”‚                         â”‚   [âœ“ ä¸‹æ³¨ç«ç„° $50]                         â”‚
â”‚                         â”‚                                            â”‚
â”‚                         â”‚   æ€»æ± : $2,150  |  87äººå‚ä¸                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”— éªŒè¯: Game #0x3f2a.. committed to Monad | View TX | IPFS | âœ…    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ç»„ä»¶ç»“æ„

```
<App>
â”œâ”€â”€ <Header />
â”‚   â”œâ”€â”€ <Logo />
â”‚   â”œâ”€â”€ <RoundIndicator />
â”‚   â”œâ”€â”€ <Timer />
â”‚   â””â”€â”€ <VerificationBadge />
â”‚
â”œâ”€â”€ <GameRoom>
â”‚   â”œâ”€â”€ <PokerTable>
â”‚   â”‚   â”œâ”€â”€ <PlayerSeat /> x 4
â”‚   â”‚   â”‚   â”œâ”€â”€ <Avatar />
â”‚   â”‚   â”‚   â”œâ”€â”€ <HoleCards />  â† ESPNå¼å…¨é€æ˜
â”‚   â”‚   â”‚   â”œâ”€â”€ <ChipStack />
â”‚   â”‚   â”‚   â””â”€â”€ <ActionBadge />
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ <CommunityCards />
â”‚   â”‚   â””â”€â”€ <PotDisplay />
â”‚   â”‚
â”‚   â”œâ”€â”€ <BottomPanel>
â”‚   â”‚   â”œâ”€â”€ <DialogueStream />  â† æ‰“å­—æœºæ•ˆæœ
â”‚   â”‚   â””â”€â”€ <BettingPanel />    â† é¢„æµ‹å¸‚åœº
â”‚   â”‚
â”‚   â””â”€â”€ <VerificationBar />     â† é“¾ä¸ŠéªŒè¯çŠ¶æ€
â”‚
â””â”€â”€ <GameEndModal />            â† ç»“ç®— + éªŒè¯å…¥å£
```

---

## 2. æŠ€æœ¯æ ˆ

| ç»„ä»¶ | é€‰æ‹© | ç†ç”± |
|------|------|------|
| æ¡†æ¶ | React 18 | ç”Ÿæ€æˆç†Ÿ |
| çŠ¶æ€ | Zustand | è½»é‡ç®€æ´ |
| åŠ¨ç”» | Framer Motion | å£°æ˜å¼ã€æ€§èƒ½å¥½ |
| æ ·å¼ | Tailwind CSS | å¿«é€Ÿå¼€å‘ |
| å®æ—¶ | Socket.io | åŒå‘é€šä¿¡ |
| æ„å»º | Vite | å¿«é€Ÿçƒ­æ›´æ–° |

---

## 3. æ ¸å¿ƒç»„ä»¶

### 3.1 ç‰Œæ¡Œç»„ä»¶ï¼ˆGod Viewï¼‰

```tsx
// components/Table/PokerTable.tsx
import { motion } from 'framer-motion';
import { useGameStore } from '@/stores/game';
import { PlayerSeat } from './PlayerSeat';
import { CommunityCards } from './CommunityCards';
import { PotDisplay } from './PotDisplay';

const SEAT_POSITIONS = [
  { x: '15%', y: '15%' },   // å·¦ä¸Š - ç«ç„°
  { x: '85%', y: '15%' },   // å³ä¸Š - å†°å±±
  { x: '15%', y: '75%' },   // å·¦ä¸‹ - è¯¡å½±
  { x: '85%', y: '75%' },   // å³ä¸‹ - é€»è¾‘
];

export function PokerTable() {
  const players = useGameStore(s => s.players);
  const communityCards = useGameStore(s => s.communityCards);
  const pot = useGameStore(s => s.pot);
  const activePlayerId = useGameStore(s => s.activePlayerId);
  
  return (
    <div className="relative w-full h-[500px] bg-gradient-to-b from-green-800 to-green-900 rounded-3xl border-4 border-amber-700 shadow-2xl">
      
      {/* å…¬å…±ç‰ŒåŒºåŸŸ */}
      <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
        <CommunityCards cards={communityCards} />
        <PotDisplay pot={pot} />
      </div>
      
      {/* ç©å®¶åº§ä½ */}
      {players.map((player, index) => (
        <PlayerSeat
          key={player.id}
          player={player}
          position={SEAT_POSITIONS[index]}
          isActive={player.id === activePlayerId}
        />
      ))}
    </div>
  );
}
```

### 3.2 ç©å®¶åº§ä½ï¼ˆå«åº•ç‰Œå±•ç¤ºï¼‰

```tsx
// components/Table/PlayerSeat.tsx
import { motion } from 'framer-motion';
import { PlayingCard } from './PlayingCard';

interface PlayerSeatProps {
  player: {
    id: string;
    name: string;
    avatar: string;
    holeCards: [string, string];  // ["Aâ™ ", "Kâ™¥"]
    stack: number;
    status: 'active' | 'allin' | 'folded' | 'eliminated';
    lastAction?: string;
  };
  position: { x: string; y: string };
  isActive: boolean;
}

export function PlayerSeat({ player, position, isActive }: PlayerSeatProps) {
  const isFolded = player.status === 'folded';
  const isEliminated = player.status === 'eliminated';
  
  return (
    <motion.div
      className="absolute transform -translate-x-1/2 -translate-y-1/2"
      style={{ left: position.x, top: position.y }}
      animate={{ 
        scale: isActive ? 1.05 : 1,
        opacity: isEliminated ? 0.4 : 1
      }}
    >
      <div className={`flex flex-col items-center p-3 rounded-xl
        ${isActive ? 'bg-yellow-500/30 ring-2 ring-yellow-400' : 'bg-black/40'}
        ${isFolded ? 'opacity-60' : ''}
      `}>
        
        {/* å¤´åƒ + åå­— */}
        <div className="flex items-center gap-2 mb-2">
          <span className="text-3xl">{player.avatar}</span>
          <span className="text-white font-bold">{player.name}</span>
        </div>
        
        {/* ğŸ”‘ æ ¸å¿ƒï¼šåº•ç‰Œå±•ç¤ºï¼ˆESPNé£æ ¼ï¼‰ */}
        <div className="flex gap-1 mb-2">
          <PlayingCard card={player.holeCards[0]} faded={isFolded} />
          <PlayingCard card={player.holeCards[1]} faded={isFolded} />
        </div>
        
        {/* ç­¹ç  */}
        <div className="text-yellow-400 font-bold text-lg">
          ${player.stack.toLocaleString()}
        </div>
        
        {/* è¡ŒåŠ¨æ ‡ç­¾ */}
        {player.status === 'allin' && (
          <motion.div
            initial={{ scale: 0 }}
            animate={{ scale: 1 }}
            className="mt-1 px-3 py-1 bg-red-600 rounded-full text-white text-sm font-bold"
          >
            ALL-IN
          </motion.div>
        )}
        {isFolded && (
          <div className="mt-1 px-3 py-1 bg-gray-600 rounded-full text-gray-300 text-sm">
            FOLD
          </div>
        )}
      </div>
    </motion.div>
  );
}
```

### 3.3 æ‰‘å…‹ç‰Œç»„ä»¶

```tsx
// components/Table/PlayingCard.tsx
import { motion } from 'framer-motion';

interface PlayingCardProps {
  card: string;  // "Aâ™ ", "Kâ™¥", "10â™¦", "Jâ™£"
  faded?: boolean;
  delay?: number;
}

const SUIT_COLORS: Record<string, string> = {
  'â™ ': 'text-gray-900',
  'â™£': 'text-gray-900', 
  'â™¥': 'text-red-600',
  'â™¦': 'text-red-600',
};

export function PlayingCard({ card, faded = false, delay = 0 }: PlayingCardProps) {
  // è§£æç‰Œé¢ï¼š"Aâ™ " â†’ rank="A", suit="â™ "
  const suit = card.slice(-1);
  const rank = card.slice(0, -1);
  
  return (
    <motion.div
      initial={{ rotateY: 180, opacity: 0 }}
      animate={{ rotateY: 0, opacity: faded ? 0.5 : 1 }}
      transition={{ duration: 0.4, delay }}
      className={`w-12 h-16 bg-white rounded-lg shadow-lg flex flex-col items-center justify-center
        ${faded ? 'grayscale' : ''}
      `}
    >
      <span className={`text-lg font-bold ${SUIT_COLORS[suit]}`}>{rank}</span>
      <span className={`text-xl ${SUIT_COLORS[suit]}`}>{suit}</span>
    </motion.div>
  );
}
```

### 3.4 å…¬å…±ç‰Œ

```tsx
// components/Table/CommunityCards.tsx
import { PlayingCard } from './PlayingCard';

export function CommunityCards({ cards }: { cards: string[] }) {
  return (
    <div className="flex gap-2 justify-center mb-2">
      {cards.map((card, i) => (
        <PlayingCard key={i} card={card} delay={i * 0.2} />
      ))}
      
      {/* ç©ºä½å ä½ç¬¦ */}
      {[...Array(5 - cards.length)].map((_, i) => (
        <div 
          key={`empty-${i}`}
          className="w-12 h-16 rounded-lg border-2 border-dashed border-green-600/50"
        />
      ))}
    </div>
  );
}
```

---

## 4. å¯¹è¯æµç»„ä»¶ï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰

### 4.1 å¯¹è¯æµ

```tsx
// components/Dialogue/DialogueStream.tsx
import { useEffect, useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useGameStore } from '@/stores/game';
import { SpeechBubble } from './SpeechBubble';

export function DialogueStream() {
  const messages = useGameStore(s => s.dialogue);
  const typingAgent = useGameStore(s => s.typingAgent);
  const typingText = useGameStore(s => s.typingText);
  
  return (
    <div className="h-[200px] overflow-y-auto space-y-2 p-3 bg-gray-900/50 rounded-xl">
      <h3 className="text-sm font-bold text-gray-400 mb-2">ğŸ’¬ AI å¯¹è¯</h3>
      
      <AnimatePresence>
        {messages.slice(-5).map((msg, i) => (
          <SpeechBubble
            key={i}
            avatar={msg.avatar}
            name={msg.name}
            text={msg.speech}
            target={msg.target}
            emotion={msg.emotion}
            isTyping={false}
          />
        ))}
      </AnimatePresence>
      
      {/* æ­£åœ¨æ‰“å­—çš„æ¶ˆæ¯ */}
      {typingAgent && (
        <SpeechBubble
          avatar={typingAgent.avatar}
          name={typingAgent.name}
          text={typingText}
          isTyping={true}
        />
      )}
    </div>
  );
}
```

### 4.2 å¯¹è¯æ°”æ³¡

```tsx
// components/Dialogue/SpeechBubble.tsx
import { motion } from 'framer-motion';

interface SpeechBubbleProps {
  avatar: string;
  name: string;
  text: string;
  target?: string;
  emotion?: string;
  isTyping: boolean;
}

const EMOTION_COLORS: Record<string, string> = {
  confident: 'border-l-yellow-500',
  angry: 'border-l-red-500',
  mocking: 'border-l-purple-500',
  nervous: 'border-l-gray-400',
  neutral: 'border-l-blue-500',
};

export function SpeechBubble({ avatar, name, text, target, emotion = 'neutral', isTyping }: SpeechBubbleProps) {
  // é«˜äº®@æåŠ
  const highlightedText = text.replace(
    /@(\S+)/g,
    '<span class="text-blue-400 font-bold">@$1</span>'
  );
  
  return (
    <motion.div
      initial={{ opacity: 0, x: -10 }}
      animate={{ opacity: 1, x: 0 }}
      className={`flex gap-2 p-2 bg-gray-800/80 rounded-lg border-l-4 ${EMOTION_COLORS[emotion]}`}
    >
      <span className="text-2xl">{avatar}</span>
      
      <div className="flex-1">
        <div className="flex items-center gap-2 mb-0.5">
          <span className="font-bold text-white text-sm">{name}</span>
          {target && (
            <span className="text-xs text-blue-400">â†’ @{target}</span>
          )}
        </div>
        
        <p 
          className="text-gray-200 text-sm"
          dangerouslySetInnerHTML={{ __html: highlightedText }}
        />
        
        {isTyping && (
          <span className="inline-block w-2 h-4 bg-white ml-0.5 animate-pulse" />
        )}
      </div>
    </motion.div>
  );
}
```

---

## 5. éªŒè¯é¢æ¿ç»„ä»¶ ğŸ†•

### 5.1 éªŒè¯çŠ¶æ€æ 

```tsx
// components/Verify/VerificationBar.tsx
import { useState } from 'react';
import { motion } from 'framer-motion';
import { useGameStore } from '@/stores/game';

export function VerificationBar() {
  const verification = useGameStore(s => s.verification);
  const [expanded, setExpanded] = useState(false);
  
  if (!verification) {
    return (
      <div className="bg-gray-800 p-2 rounded-lg text-center text-gray-500 text-sm">
        ğŸ”— ç­‰å¾…æ¸¸æˆç»“æŸåé“¾ä¸Šå­˜è¯...
      </div>
    );
  }
  
  return (
    <motion.div
      layout
      className="bg-gradient-to-r from-green-900/50 to-blue-900/50 rounded-lg border border-green-500/30 overflow-hidden"
    >
      {/* ç®€æ´è§†å›¾ */}
      <div 
        className="flex items-center justify-between p-3 cursor-pointer"
        onClick={() => setExpanded(!expanded)}
      >
        <div className="flex items-center gap-2">
          <span className="text-green-400">âœ…</span>
          <span className="text-white text-sm">
            Game #{verification.gameId.slice(0, 8)}... committed to Monad
          </span>
        </div>
        
        <div className="flex items-center gap-3 text-sm">
          <a 
            href={verification.explorerUrl}
            target="_blank"
            className="text-blue-400 hover:underline"
            onClick={e => e.stopPropagation()}
          >
            View TX
          </a>
          <a 
            href={`https://w3s.link/ipfs/${verification.ipfsCid}`}
            target="_blank"
            className="text-purple-400 hover:underline"
            onClick={e => e.stopPropagation()}
          >
            IPFS
          </a>
          <button
            onClick={(e) => {
              e.stopPropagation();
              setExpanded(!expanded);
            }}
            className="text-yellow-400 hover:text-yellow-300"
          >
            ğŸ” Verify
          </button>
        </div>
      </div>
      
      {/* å±•å¼€çš„éªŒè¯é¢æ¿ */}
      {expanded && (
        <motion.div
          initial={{ height: 0 }}
          animate={{ height: 'auto' }}
          className="border-t border-green-500/30 p-4"
        >
          <VerificationPanel verification={verification} />
        </motion.div>
      )}
    </motion.div>
  );
}
```

### 5.2 éªŒè¯æ¼”ç¤ºé¢æ¿

```tsx
// components/Verify/VerificationPanel.tsx
import { useState } from 'react';
import { motion } from 'framer-motion';
import { keccak256, toUtf8Bytes } from 'ethers';

interface VerificationPanelProps {
  verification: {
    gameId: string;
    ipfsCid: string;
    onChainHash: string;
    explorerUrl: string;
  };
}

type VerifyStep = 'idle' | 'fetching' | 'computing' | 'comparing' | 'done';

export function VerificationPanel({ verification }: VerificationPanelProps) {
  const [step, setStep] = useState<VerifyStep>('idle');
  const [rawData, setRawData] = useState<string>('');
  const [computedHash, setComputedHash] = useState<string>('');
  const [isMatch, setIsMatch] = useState<boolean | null>(null);
  
  const runVerification = async () => {
    // Step 1: ä»IPFSè·å–
    setStep('fetching');
    const response = await fetch(`https://w3s.link/ipfs/${verification.ipfsCid}`);
    const data = await response.text();
    setRawData(data.slice(0, 200) + '...');
    
    // Step 2: è®¡ç®—å“ˆå¸Œ
    await sleep(600);
    setStep('computing');
    const hash = keccak256(toUtf8Bytes(data));
    setComputedHash(hash);
    
    // Step 3: æ¯”å¯¹
    await sleep(600);
    setStep('comparing');
    const matched = hash.toLowerCase() === verification.onChainHash.toLowerCase();
    setIsMatch(matched);
    
    await sleep(400);
    setStep('done');
  };
  
  return (
    <div className="space-y-4">
      {step === 'idle' && (
        <button
          onClick={runVerification}
          className="w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 
                     rounded-lg font-bold text-white
                     hover:from-blue-500 hover:to-purple-500"
        >
          ğŸ” å¼€å§‹éªŒè¯æ•°æ®å®Œæ•´æ€§
        </button>
      )}
      
      {step !== 'idle' && (
        <div className="space-y-3">
          <StepIndicator 
            label="1. ä» IPFS è·å–åŸå§‹æ•°æ®"
            status={step === 'fetching' ? 'loading' : 'done'}
          />
          
          <StepIndicator 
            label="2. æœ¬åœ°è®¡ç®— keccak256 å“ˆå¸Œ"
            status={step === 'fetching' ? 'pending' : step === 'computing' ? 'loading' : 'done'}
          />
          
          <StepIndicator 
            label="3. ä¸é“¾ä¸Šå“ˆå¸Œæ¯”å¯¹"
            status={['fetching', 'computing'].includes(step) ? 'pending' : step === 'comparing' ? 'loading' : 'done'}
          />
          
          {step === 'done' && (
            <motion.div
              initial={{ scale: 0.9, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              className={`p-4 rounded-lg text-center ${
                isMatch 
                  ? 'bg-green-900/50 border border-green-500' 
                  : 'bg-red-900/50 border border-red-500'
              }`}
            >
              <div className="text-4xl mb-2">{isMatch ? 'âœ…' : 'âŒ'}</div>
              <div className={`font-bold ${isMatch ? 'text-green-400' : 'text-red-400'}`}>
                {isMatch ? 'éªŒè¯é€šè¿‡ï¼æ•°æ®å®Œæ•´æœªç¯¡æ”¹' : 'éªŒè¯å¤±è´¥ï¼æ•°æ®å¯èƒ½è¢«ç¯¡æ”¹'}
              </div>
              
              <div className="mt-3 text-xs font-mono text-left space-y-1">
                <div>
                  <span className="text-gray-500">é“¾ä¸Š: </span>
                  <span className="text-blue-400 break-all">{verification.onChainHash}</span>
                </div>
                <div>
                  <span className="text-gray-500">è®¡ç®—: </span>
                  <span className={`break-all ${isMatch ? 'text-green-400' : 'text-red-400'}`}>
                    {computedHash}
                  </span>
                </div>
              </div>
            </motion.div>
          )}
        </div>
      )}
    </div>
  );
}

function StepIndicator({ label, status }: { label: string; status: 'pending' | 'loading' | 'done' }) {
  return (
    <div className="flex items-center gap-3 text-sm">
      {status === 'pending' && <span className="text-gray-500">â—‹</span>}
      {status === 'loading' && (
        <motion.span animate={{ rotate: 360 }} transition={{ repeat: Infinity, duration: 1 }}>
          â—
        </motion.span>
      )}
      {status === 'done' && <span className="text-green-400">âœ“</span>}
      <span className={status === 'pending' ? 'text-gray-500' : 'text-white'}>{label}</span>
    </div>
  );
}

const sleep = (ms: number) => new Promise(r => setTimeout(r, ms));
```

---

## 6. çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰

```typescript
// stores/game.ts
import { create } from 'zustand';

interface Player {
  id: string;
  name: string;
  avatar: string;
  holeCards: [string, string];
  stack: number;
  status: 'active' | 'allin' | 'folded' | 'eliminated';
}

interface DialogueMessage {
  name: string;
  avatar: string;
  speech: string;
  emotion: string;
  target?: string;
}

interface VerificationData {
  gameId: string;
  ipfsCid: string;
  onChainHash: string;
  explorerUrl: string;
  txHash: string;
}

interface GameState {
  // æ¸¸æˆçŠ¶æ€
  gameId: string | null;
  phase: 'waiting' | 'playing' | 'showdown' | 'ended';
  round: number;
  players: Player[];
  communityCards: string[];
  pot: number;
  activePlayerId: string | null;
  
  // å¯¹è¯
  dialogue: DialogueMessage[];
  typingAgent: { name: string; avatar: string } | null;
  typingText: string;
  
  // éªŒè¯
  verification: VerificationData | null;
  
  // Actions
  setGameState: (state: Partial<GameState>) => void;
  addDialogue: (msg: DialogueMessage) => void;
  setTyping: (agent: { name: string; avatar: string } | null, text?: string) => void;
  appendTypingText: (chunk: string) => void;
  setVerification: (data: VerificationData) => void;
  reset: () => void;
}

export const useGameStore = create<GameState>((set, get) => ({
  gameId: null,
  phase: 'waiting',
  round: 1,
  players: [],
  communityCards: [],
  pot: 0,
  activePlayerId: null,
  dialogue: [],
  typingAgent: null,
  typingText: '',
  verification: null,
  
  setGameState: (state) => set(state),
  
  addDialogue: (msg) => set(s => ({
    dialogue: [...s.dialogue.slice(-20), msg]  // ä¿ç•™æœ€è¿‘20æ¡
  })),
  
  setTyping: (agent, text = '') => set({ typingAgent: agent, typingText: text }),
  
  appendTypingText: (chunk) => set(s => ({
    typingText: s.typingText + chunk
  })),
  
  setVerification: (data) => set({ verification: data }),
  
  reset: () => set({
    gameId: null,
    phase: 'waiting',
    round: 1,
    players: [],
    communityCards: [],
    pot: 0,
    activePlayerId: null,
    dialogue: [],
    typingAgent: null,
    typingText: '',
    verification: null,
  }),
}));
```

---

## 7. Socket.io é›†æˆ

```typescript
// lib/socket.ts
import { io, Socket } from 'socket.io-client';
import { useGameStore } from '@/stores/game';

let socket: Socket;

export function initSocket(serverUrl: string) {
  socket = io(serverUrl);
  
  // æ¸¸æˆçŠ¶æ€æ›´æ–°
  socket.on('game_state', (state) => {
    useGameStore.getState().setGameState(state);
  });
  
  // AIå¼€å§‹æ€è€ƒ
  socket.on('ai_thinking', (data) => {
    useGameStore.getState().setTyping({
      name: data.agentName,
      avatar: data.avatar
    });
  });
  
  // AIå¯¹è¯æµå¼è¾“å‡º
  socket.on('ai_speech_chunk', (data) => {
    useGameStore.getState().appendTypingText(data.chunk);
  });
  
  // AIå†³ç­–å®Œæˆ
  socket.on('ai_decision', (data) => {
    const store = useGameStore.getState();
    
    // å®Œæˆæ‰“å­—
    store.setTyping(null);
    
    // æ·»åŠ å®Œæ•´æ¶ˆæ¯
    store.addDialogue({
      name: data.agentName,
      avatar: data.avatar,
      speech: data.speech,
      emotion: data.emotion,
      target: data.target
    });
  });
  
  // é“¾ä¸ŠéªŒè¯å®Œæˆ
  socket.on('game_committed', (data) => {
    useGameStore.getState().setVerification(data);
  });
  
  return socket;
}

export function joinGame(gameId: string) {
  socket.emit('join_game', gameId);
}

export function placeBet(gameId: string, aiId: string, amount: number) {
  socket.emit('place_bet', { gameId, aiId, amount });
}
```

---

## 8. ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Table/
â”‚   â”‚   â”œâ”€â”€ PokerTable.tsx
â”‚   â”‚   â”œâ”€â”€ PlayerSeat.tsx
â”‚   â”‚   â”œâ”€â”€ PlayingCard.tsx
â”‚   â”‚   â”œâ”€â”€ CommunityCards.tsx
â”‚   â”‚   â””â”€â”€ PotDisplay.tsx
â”‚   â”œâ”€â”€ Dialogue/
â”‚   â”‚   â”œâ”€â”€ DialogueStream.tsx
â”‚   â”‚   â””â”€â”€ SpeechBubble.tsx
â”‚   â”œâ”€â”€ Market/
â”‚   â”‚   â”œâ”€â”€ BettingPanel.tsx
â”‚   â”‚   â””â”€â”€ LiveBetFeed.tsx
â”‚   â”œâ”€â”€ Verify/
â”‚   â”‚   â”œâ”€â”€ VerificationBar.tsx
â”‚   â”‚   â””â”€â”€ VerificationPanel.tsx
â”‚   â””â”€â”€ Layout/
â”‚       â”œâ”€â”€ Header.tsx
â”‚       â””â”€â”€ GameRoom.tsx
â”œâ”€â”€ stores/
â”‚   â””â”€â”€ game.ts
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ socket.ts
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ index.tsx         # é¦–é¡µ/å¤§å…
â”‚   â””â”€â”€ game/[id].tsx     # æ¸¸æˆæˆ¿é—´
â””â”€â”€ styles/
    â””â”€â”€ globals.css
```

---

## 9. å¼€å‘è®¡åˆ’

| ä»»åŠ¡ | æ—¶é—´ | ä¼˜å…ˆçº§ |
|------|------|--------|
| PokerTable + PlayerSeat | 3h | P0 |
| PlayingCard + åŠ¨ç”» | 2h | P0 |
| DialogueStream æ‰“å­—æœº | 2h | P0 |
| VerificationPanel | 2h | P0 |
| BettingPanel | 2h | P1 |
| Socket.io é›†æˆ | 1h | P0 |

**æ€»è®¡**: 12h

---

## 10. æ¼”ç¤ºè¯æœ¯

> "è¿™æ˜¯æˆ‘ä»¬çš„è§‚æˆ˜ç•Œé¢â€”â€”ESPNå¼çš„'ä¸Šå¸è§†è§’'ã€‚
>
> ä½ å¯ä»¥çœ‹åˆ°æ¯ä¸ªAIçš„åº•ç‰Œï¼šç«ç„°æ‹¿ç€Aâ™  Kâ™¥ï¼Œå†°å±±æ˜¯ä¸€å¯¹Q...
>
> **[æŒ‡å‘å¯¹è¯åŒº]**
> è¿™é‡Œæ˜¯AIä¹‹é—´çš„å®æ—¶å¯¹è¯ã€‚æ³¨æ„çœ‹ï¼Œç«ç„°æ­£åœ¨æ‰“å­—...
>
> '@ å†°å±± åˆç¼©äº†ï¼Ÿ' â€”â€” æ¯æ¡æ¶ˆæ¯éƒ½æ˜¯æµå¼è¾“å‡ºçš„ï¼ŒåƒçœŸäººåœ¨æ‰“å­—ã€‚
>
> **[æŒ‡å‘éªŒè¯æ ]**
> æ¸¸æˆç»“æŸåï¼Œæ‰€æœ‰æ•°æ®ä¼šè¢«ä¸Šä¼ åˆ°IPFSï¼Œå“ˆå¸Œå€¼å†™å…¥Monadé“¾ã€‚
>
> ç‚¹å‡»'Verify'æŒ‰é’®ï¼Œæˆ‘ä»¬å¯ä»¥ç°åœºæ¼”ç¤ºéªŒè¯æµç¨‹â€”â€”
> ä»IPFSä¸‹è½½æ•°æ®ï¼Œæœ¬åœ°è®¡ç®—å“ˆå¸Œï¼Œä¸é“¾ä¸Šæ¯”å¯¹...
>
> âœ… éªŒè¯é€šè¿‡ï¼è¿™è¯æ˜äº†AIå†³ç­–è¿‡ç¨‹çš„ä¸å¯ç¯¡æ”¹æ€§ã€‚"
